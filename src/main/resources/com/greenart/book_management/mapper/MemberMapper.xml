<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.greenart.book_management.mapper.MemberMapper">
    <insert id="addMemberInfo">
    INSERT INTO book_db.member_info
    (mi_bi_seq, mi_name, mi_birth, mi_pwd, mi_phone_num, mi_email, mi_status)
    VALUES(#{mi_bi_seq}, #{mi_name}, #{mi_birth}, #{mi_pwd}, #{mi_phone_num}, #{mi_email}, #{mi_status})
    </insert>
    <select id="getMemberList" resultType="com.greenart.book_management.data.MemberVO">
        select mi_seq, book_title, mi_name, mi_birth, mi_phone_num, mi_email, mi_reg_dt, mi_mod_dt, mi_status from
        (
            select a.*, b.bi_title as book_title
            from member_info a left outer join book_info b
            on a.mi_bi_seq = b.bi_seq
        ) c
        <if test="type == 'title'">
            where book_title like #{keyword}
        </if>
        <if test="type == 'name'">
            where mi_name like #{keyword}
        </if>
        order by mi_seq desc
        limit 10 offset #{offset}
    </select>
        <select id="getMemberCnt" resultType="java.lang.Integer">
        select count(*) from (
            select a.*, b.bi_title as book_title
            from member_info a left outer join book_info b
            on a.mi_bi_seq = b.bi_seq
        ) c
        <if test="type == 'title'">
            where book_title like #{keyword}
        </if>
        <if test="type == 'name'">
            where mi_name like #{keyword}
        </if>
    </select>
</mapper>